---
id: T29.2
title: Add Sandbox Section to config.yaml
status: pending
priority: P0
complexity: 20
plan: plan-2026-01-sprint-29-contained-autonomy
depends_on: [T29.1]
---

# Objective

Wire the sandbox config schema into the main config loading and validation system, and add sandbox section to project templates.

# Files to Update

| File | Change |
|------|--------|
| `tools/cli/bpsai_pair/core/config.py` | Add `sandbox: SandboxConfig` to `ConfigModel` |
| `tools/cli/bpsai_pair/data/cookiecutter-paircoder/{{cookiecutter.project_slug}}/.paircoder/config.yaml` | Add sandbox section |
| `tools/cli/bpsai_pair/commands/core.py` | Update init command (if needed) |

# Implementation Plan

1. Add `sandbox: SandboxConfig` field to `ConfigModel` with default

2. Update cookiecutter template with sandbox section:
   ```yaml
   sandbox:
     enabled: false
     locked_directories:
       - .claude/agents/
       - .claude/commands/
       - .claude/skills/
     locked_files:
       - CLAUDE.md
       - AGENTS.md
     allow_network:
       - api.anthropic.com
       - api.trello.com
       - github.com
       - pypi.org
     auto_checkpoint: true
     rollback_on_violation: false
   ```

3. Ensure `bpsai-pair validate` checks sandbox config

4. Test config loading with and without sandbox section

# Acceptance Criteria

- [ ] `sandbox:` section recognized in config.yaml
- [ ] Config validation includes sandbox settings
- [ ] Default sandbox config generated on `bpsai-pair init`
- [ ] Cookiecutter template updated with sandbox section
- [ ] `bpsai-pair validate` checks sandbox config
- [ ] Config without sandbox section uses defaults (backward compatible)

# Verification

```bash
# Test config loading
bpsai-pair validate

# Test init with sandbox
bpsai-pair init test-project --dry-run

# Run config tests
pytest tests/core/test_config.py -v
```

# Test Cases

- Config without sandbox section uses defaults
- Config with partial sandbox section merges with defaults
- Invalid sandbox config fails validation with clear error
