---
id: T29.2
title: Add Containment Section to config.yaml
status: done
priority: P0
complexity: 20
plan: plan-2026-01-sprint-29-contained-autonomy
depends_on:
- T29.1
---

# Objective

Wire the containment config schema into the main config loading and validation system, and add containment section to project templates.

# Files to Update

| File | Change |
|------|--------|
| `tools/cli/bpsai_pair/core/config.py` | Add `containment: ContainmentConfig` to `Config` |
| `tools/cli/bpsai_pair/data/cookiecutter-paircoder/{{cookiecutter.project_slug}}/.paircoder/config.yaml` | Add containment section |
| `tools/cli/bpsai_pair/core/presets.py` | Add containment section to presets |

# Implementation Plan

1. Add `containment: ContainmentConfig` field to `Config` dataclass with default

2. Update cookiecutter template with containment section:
   ```yaml
   containment:
     enabled: false
     locked_directories:
       - .claude/agents/
       - .claude/commands/
       - .claude/skills/
     locked_files:
       - CLAUDE.md
       - AGENTS.md
     allow_network:
       - api.anthropic.com
       - api.trello.com
       - github.com
       - pypi.org
     auto_checkpoint: true
     rollback_on_violation: false
   ```

3. Ensure `bpsai-pair validate` checks containment config

4. Test config loading with and without containment section

# Acceptance Criteria

- [x] `containment:` section recognized in config.yaml
- [x] Config validation includes containment settings
- [x] Default containment config generated on `bpsai-pair init`
- [x] Cookiecutter template updated with containment section
- [x] `bpsai-pair validate` checks containment config
- [x] Config without containment section uses defaults (backward compatible)

# Verification

```bash
# Test config loading
bpsai-pair validate

# Test init with containment
bpsai-pair init test-project --dry-run

# Run config tests
pytest tests/core/test_containment_config_integration.py -v
```

# Test Cases

- Config without containment section uses defaults
- Config with partial containment section merges with defaults
- Invalid containment config fails validation with clear error
