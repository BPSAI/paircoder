---
id: T19.2
title: Session Restart Enforcement
plan: plan-2025-12-sprint-19-methodology
type: feature
priority: P0
complexity: 45
status: done
depends_on: []
tags:
- session
- context
- methodology
---

# Objective

Detect when a new Claude Code session starts and prompt for state.md read. Prevent Claude from starting work without context.

# Implementation

Add startup detection that:
1. Checks for session continuity markers
2. If new session detected, prompts to read state.md
3. Logs session start in history

## Detection Methods

1. **Timestamp gap:** >30 min since last activity
2. **Explicit signal:** `/clear` was run
3. **Session ID change:** Different Claude session ID

## Startup Message

```
ðŸ”„ New session detected. Loading context...

Current state from .paircoder/context/state.md:
- Active plan: sprint-18-release-engineering
- Current task: T18.2 (in_progress)
- Last session: Completed T18.1

Continue with T18.2 or run `bpsai-pair status` for full context?
```

# Acceptance Criteria

- [ ] Detects new session start (>30 min gap or explicit signal)
- [ ] Automatically reads and displays state.md summary
- [ ] Shows current task status and last session activity
- [ ] Logs session start time to history/sessions log
- [ ] Works with Claude Code hooks system
- [ ] Unit tests for detection logic

# Files to Modify

- `src/bpsai_pair/session/` - New session module
- `.claude/hooks/` - Add session detection hook
- `tests/test_session.py`

# Dependencies

None