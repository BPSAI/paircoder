---
id: T29.10
title: Document Contained Autonomy Mode
status: done
priority: P1
complexity: 30
plan: plan-2026-01-sprint-29-contained-autonomy
depends_on:
- T29.4
---

# Objective

Create comprehensive documentation for the contained autonomy feature.

# Files to Update

| File | Change |
|------|--------|
| `.paircoder/docs/USER_GUIDE.md` | Add Contained Autonomy section |
| `CLAUDE.md` | Add containment instructions |
| `docs/CONTAINED_AUTONOMY.md` | Create full documentation |

# Implementation Plan

1. Create `docs/CONTAINED_AUTONOMY.md` with:
   - Overview: What it is and why it exists
   - Quick Start: Basic usage
   - Configuration: Full config reference
   - Protected Paths: What's locked and why
   - Network Restrictions: Allowed domains
   - Checkpoints: How rollback works
   - FAQ: Common questions
   - Troubleshooting: Common issues

2. Update `USER_GUIDE.md`:
   - Add section on contained autonomy
   - Reference the full documentation
   - Add example config

3. Update `CLAUDE.md`:
   - Add note about containment mode
   - Explain when Claude should expect restrictions

# Acceptance Criteria

- [ ] `USER_GUIDE.md` updated with Contained Autonomy section
- [ ] `CLAUDE.md` updated with containment instructions
- [ ] New doc: `docs/CONTAINED_AUTONOMY.md` with full details
- [ ] FAQ: When to use contained mode vs normal mode
- [ ] Troubleshooting guide for common containment issues
- [ ] All examples verified to work

# Verification

```bash
# Check documentation renders
cat docs/CONTAINED_AUTONOMY.md | head -50

# Verify code examples
grep -A5 "```yaml" docs/CONTAINED_AUTONOMY.md | head -20
```

# Documentation Outline

```markdown
# Contained Autonomy Mode

## Overview
What contained autonomy is and why it exists. Explains the problem of Claude
editing enforcement code to bypass restrictions.

## Quick Start

$ bpsai-pair claude666

## How It Works

1. Git checkpoint created (auto-rollback point)
2. Enforcement directories mounted read-only
3. Network restricted to allowlist
4. Claude works autonomously... safely

## Configuration

containment:
  enabled: true
  locked_directories:
    - .claude/agents/
    - .claude/commands/
    - .claude/skills/
    - tools/cli/bpsai_pair/security/
    - tools/cli/bpsai_pair/core/
  locked_files:
    - .paircoder/config.yaml
    - CLAUDE.md
    - AGENTS.md
  allow_network:
    - api.anthropic.com
    - api.trello.com
    - github.com
    - pypi.org
  auto_checkpoint: true
  rollback_on_violation: false

## Protected Paths
Explains what paths are protected by default and why:
- `.claude/agents/` - Role definitions
- `.claude/commands/` - Slash command implementations
- `.claude/skills/` - Skill definitions
- `security/` - Security enforcement code
- `core/` - Core CLI infrastructure

## Network Restrictions
What domains are allowed by default and how to add more.

## Checkpoints and Rollback

### Creating Checkpoints
Automatic on containment entry unless `--skip-checkpoint`.

### Rolling Back
$ bpsai-pair containment rollback

### Manual Recovery
$ git reset --hard containment-YYYYMMDD-HHMMSS

## FAQ

### When should I use contained mode?
Use when you want Claude to work autonomously on implementation tasks
without risk of accidentally modifying enforcement infrastructure.

### Can I add my own locked paths?
Yes, add them to `locked_directories` or `locked_files` in config.

### How do I disable sandbox temporarily?
Don't use `claude666` - use normal commands instead.

### What if Claude needs to modify a protected file?
Exit containment mode, make the change manually or with normal commands.

## Troubleshooting

### "Cannot modify locked path" error
You're in containment mode and trying to edit a protected file. Exit sandbox
or use `containment rollback`.

### Network restriction errors
The domain isn't in `allow_network`. Add it to config or work offline.

### Checkpoint rollback issues
Ensure checkpoint tag exists: `git tag -l "containment-*"`
```

# Test Cases

- Documentation renders correctly
- All code examples are valid YAML/Python
- Internal links work