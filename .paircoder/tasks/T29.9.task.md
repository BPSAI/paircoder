---
id: T29.9
title: Add Containment Status to bpsai-pair status
status: in_progress
priority: P1
complexity: 20
plan: plan-2026-01-sprint-29-contained-autonomy
depends_on:
- T29.4
---

# Objective

Show containment status in the main status command output when containment is configured or active.

# Files to Update

| File | Change |
|------|--------|
| `tools/cli/bpsai_pair/commands/core.py` | Add containment section to `status` command output |

# Implementation Plan

1. Detect containment state:
   - Check `PAIRCODER_CONTAINMENT` environment variable for active state
   - Check config for containment settings

2. Add containment section to status output:
   - Show active/inactive/not configured state
   - Show checkpoint ID if active
   - Show count of locked paths
   - Show network restriction status

3. Use color coding:
   - Green: Active and protecting
   - Yellow: Configured but not active
   - Gray: Not configured

4. Show protected paths summary (not full list)

# Acceptance Criteria

- [ ] Containment section appears in status output when containment enabled in config
- [ ] Shows: active/inactive, locked paths count, checkpoint ID
- [ ] Color coding: green (active), yellow (configured), gray (not configured)
- [ ] Network allowlist shown when active

# Verification

```bash
# Without sandbox configured
bpsai-pair status
# Should show containment section in gray or not show it

# With sandbox configured
# (add containment section to config.yaml first)
bpsai-pair status
# Should show containment section in yellow

# With sandbox active
PAIRCODER_CONTAINMENT=1 bpsai-pair status
# Should show containment section in green
```

# Output Example

```
$ bpsai-pair status

Project: paircoder (v2.9.1)
Branch: feature/contained-autonomy
Plan: plan-2026-01-sprint-29-contained-autonomy

Containment Status
   Mode: ACTIVE (contained autonomy)
   Checkpoint: sandbox-20260113-143022
   Locked Paths: 6 directories, 3 files
   Network: Restricted (4 domains allowed)

   Protected:
   - .claude/agents/
   - .claude/commands/
   - .claude/skills/
   - tools/cli/bpsai_pair/security/
   - tools/cli/bpsai_pair/core/
   - .paircoder/config.yaml
```

# Implementation Notes

```python
# In core.py status command, add after current output:

def _show_containment_status(config):
    """Show containment status section."""
    containment = config.containment
    active = os.environ.get("PAIRCODER_CONTAINMENT") == "1"

    if not containment.enabled and not active:
        return  # Don't show if not configured

    console.print()
    console.print("[bold]Containment Status[/bold]")

    if active:
        checkpoint = os.environ.get("PAIRCODER_CONTAINMENT_CHECKPOINT", "none")
        console.print(f"   Mode: [green]ACTIVE[/green] (contained autonomy)")
        console.print(f"   Checkpoint: {checkpoint}")
    elif containment.enabled:
        console.print(f"   Mode: [yellow]CONFIGURED[/yellow] (not active)")
    else:
        console.print(f"   Mode: [dim]NOT CONFIGURED[/dim]")
        return

    dir_count = len(containment.locked_directories)
    file_count = len(containment.locked_files)
    console.print(f"   Locked Paths: {dir_count} directories, {file_count} files")

    net_count = len(containment.allow_network)
    console.print(f"   Network: Restricted ({net_count} domains allowed)")

    if containment.locked_directories or containment.locked_files:
        console.print()
        console.print("   [dim]Protected:[/dim]")
        for d in containment.locked_directories[:5]:
            console.print(f"   [dim]-[/dim] {d}")
        if len(containment.locked_directories) > 5:
            console.print(f"   [dim]... and {len(containment.locked_directories) - 5} more[/dim]")
```

# Test Cases

- Status shows containment section when enabled
- Status hides containment section when disabled/not configured
- Correct path counts displayed
- Network status accurate
- Active state detected from environment