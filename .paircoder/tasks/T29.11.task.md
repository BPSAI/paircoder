---
id: T29.11
title: Create Subagent Invocation Documentation
status: pending
priority: P2
complexity: 30
plan: plan-2026-01-sprint-29-contained-autonomy
---

# Objective

Document how to properly invoke subagents (planner, reviewer, security) and how they interact with contained mode.

# Files to Update

| File | Change |
|------|--------|
| `docs/SUBAGENT_INVOCATION.md` | Create new documentation |

# Implementation Plan

1. Document available subagents:
   - Planner agent
   - Reviewer agent
   - Security agent

2. Explain how Claude Code discovers and uses agents

3. Document agent file structure

4. Explain containment considerations for agents

5. Provide examples of custom subagent creation

# Acceptance Criteria

- [ ] Document: `docs/SUBAGENT_INVOCATION.md` created
- [ ] Explains subagent roles and when to use each
- [ ] Shows how to invoke subagents from Claude Code
- [ ] Explains subagent file locations and structure
- [ ] Integration with containment mode documented

# Verification

```bash
# Check documentation exists
cat docs/SUBAGENT_INVOCATION.md | head -50

# Verify agent files mentioned exist
ls .claude/agents/
```

# Documentation Outline

```markdown
# Subagent Invocation Guide

## Overview

Subagents are specialized AI role definitions that guide Claude Code's behavior
for specific types of tasks. They're defined in `.claude/agents/` and automatically
loaded by Claude Code.

## Available Subagents

| Agent | Location | Purpose |
|-------|----------|---------|
| Planner | `.claude/agents/planner.md` | Strategic planning and design |
| Reviewer | `.claude/agents/reviewer.md` | Code review and quality checks |
| Security | `.claude/agents/security.md` | Pre-execution security gating |

## How Subagents Work

1. Claude Code reads agent definitions from `.claude/agents/`
2. The Task tool specifies `subagent_type` to select an agent
3. Agent context is injected into the subagent's system prompt
4. Subagent executes with the specified tools and constraints

## Invoking Subagents

From Claude Code, use the Task tool with `subagent_type`:

{
  "subagent_type": "reviewer",
  "prompt": "Review the changes in src/auth.py",
  "description": "Code review"
}

## Agent File Structure

Each agent definition file follows this structure:

---
name: agent-name
description: Brief description
tools: [Read, Grep, Glob]  # Available tools
read_only: true  # If agent cannot write
---

# Agent Name

## Role
Describe the agent's role and expertise.

## Instructions
Specific guidelines for behavior.

## Constraints
What the agent should NOT do.

## Creating Custom Subagents

1. Create a new file in `.claude/agents/your-agent.md`
2. Add frontmatter with name, description, tools
3. Write the agent's instructions in markdown
4. Reference in Task tool calls

### Example: Testing Agent

---
name: tester
description: Runs tests and reports results
tools: [Bash, Read]
---

# Testing Agent

## Role
Execute test suites and analyze failures.

## Instructions
1. Run the appropriate test command for the project
2. Analyze any failures
3. Provide clear summaries

## Containment Considerations

In contained autonomy mode:
- Agent definition files are READ-ONLY
- Agents cannot modify their own definitions
- Agents cannot modify other agents
- This prevents "jailbreak" attempts where Claude modifies agent constraints

### Why This Matters

Without containment protection, Claude could:
1. Read the security agent definition
2. Edit it to remove constraints
3. Invoke the modified agent to bypass security

With containment protection, step 2 fails with `ContainmentViolationError`.

## Troubleshooting

### Agent not found
Ensure file exists in `.claude/agents/` with `.md` extension.

### Agent tools limited
Check the `tools` list in agent frontmatter.

### Can't modify agent in sandbox
By design. Exit containment mode to modify agents.
```

# Test Cases

- Documentation renders correctly
- All referenced agent files exist
- Examples are accurate
